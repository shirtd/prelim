% !TeX root = new.tex

\begin{theorem}\label{thm:main}
  Let $(\D, \B)$ be a surrounding pair of open subsets of $\R^d$ and let $P\subset \D$ be a finite subset of $\D$.
  Let $(P, Q)$ be an (open) separating $(\delta,\gamma)$-cover of $(\D, \B)$ for $\gamma > \delta > 0$.
  Let $(D_0, B_0)$ and $(D_1, B_1)$ be surrounding pairs of nonempty, compact subsets of $\R^d$ such that $B_0\subseteq \hat{Q^\delta}$, $\hat{Q^\gamma}\subseteq B_1$, and
  \[ (D_0, B_0)\subset (\D, \B) \subset (D_1, B_1).\]

  If
  \[\im~\hom_k((D_0, B_0)\hookrightarrow (D_1, B_1))\cong \hom_k(\D, \B)\]
  then
  \[\im~\hom_k((P^\delta, Q^\delta)\hookrightarrow (P^\gamma, Q^\gamma))\cong \hom_k(\D, \B).\]
\end{theorem}
\begin{proof}

  In the following let
  \begin{align*}
    \eta_B^k &: \hom_k(B_0)\to \hom_k(B_1),\\
    \eta_D^k &: \hom_k(D_0)\to \hom_k(D_1),\text{ and }\\
    \eta^k &: \hom_k(D_0, B_0)\to \hom_k(D_1, B_1).
  \end{align*}

  Consider the commutative diagram of long exact sequences of the pairs $(D_0, B_0), (\D, \B)$ and $(D_1, B_1)$.

  \begin{equation}\begin{tikzcd}
      \hom_k(B_0)\arrow{r}{i^k_0}\arrow{d}{a^k} &
      \hom_k(D_0)\arrow{r}{j^k_0} \arrow{d}{b^k} &
      \hom_k(D_0, B_0)\arrow{r}{\partial^k_0}\arrow{d}{d^k} &
      \hom_{k-1}(B_0)\arrow{r}{i^{k-1}_0}\arrow{d}{a^{k-1}} &
      \hom_{k-1}(D_0) \arrow{d}{b^{k-1}}\\
      %
      \hom_k(\B)\arrow{r}{i_*^k}\arrow{d}{f^k} &
      \hom_k(\D)\arrow{r}{j_*^k}\arrow{d}{g^k} &
      \hom_k(\D, \B)\arrow{r}{\partial_*^k}\arrow{d}{h^k} &
      \hom_{k-1}(\B)\arrow{r}{i_*^{k-1}}\arrow{d}{f^{k-1}} &
      \hom_{k-1}(\D)\arrow{d}{g^{k-1}}\\
      %
      \hom_k(B_1)\arrow{r}{i^k_1} &
      \hom_k(D_1)\arrow{r}{j^k_1} &
      \hom_k(D_1, B_1)\arrow{r}{\partial^k_1} &
      \hom_{k-1}(B_1)\arrow{r}{i^{k-1}_1} &
      \hom_{k-1}(D_1)
  \end{tikzcd}\end{equation}

  Because $(D_0, B_0)$ and $(D_1, B_1)$ are nonempty, compact surrounding pairs of $\R^d$ we can embed them in $S^d \cong \R^d\cup\{\infty\}$ in order to show that $i_0^k$ and $i_1^k$ are surjective by Lemma~\ref{lem:alexander_comm}.
  So, by exactness, $\im~i_0^k = \ker~j_0^k = \hom_k(D_0)$ and $\im~i_1^k = \ker~j_1^k = \hom_k(D_1)$.
  It follows that for any $[y''] \in \im~\eta^k$ with preimage $[y]\in \hom_k(D_0, B_0)$ we must have that $[y'']\in\cok~j^k_1$ and $[y]\in\cok~j^k_0$.
  That is, there must exist nonzero $[z] = \partial_0^k[y]$ in $\hom_{k-1}(B_0)$ and $[z''] = \partial_1^k[y'']$ in $\hom_{k-1}(B_1)$ such that $\eta_B^{k-1}[z] = [z'']$.
  Moreover, because $\eta^k$ factors through $\hom_k(\D, \B)$ and $\eta^{k-1}_B$ factors through $\hom_{k-1}(\B)$ there must exist nonzero $[y'] = d^k[y]$ in $\hom_k(\D, \B)$ and $[z'] = \partial^k_*[y'] = a^{k-1}[z]$ in $\hom_{k-1}(\B)$ such that $h^k[y'] = [y'']$ and $f^{k-1}[z'] = [z'']$.

  Consider the long exact sequence of the pair $(\D, \hat{Q^\delta})$
  \[\ldots\to\hom_k(\D, \hat{Q^\delta})\xrightarrow{\partial^k_\delta}
    \hom_{k-1}(\hat{Q^\delta})\xrightarrow{p^{k-1}_\delta}
    \hom_{k-1}(\D)\to\ldots,\]
  and the following commutative diagrams taken from the long exact sequences of the pairs $(\D, \hat{Q^\delta})$ and $(\D, \B)$.

  \begin{equation}\label{eq:main1}\begin{tikzcd}
      \hom_{k-1}(\hat{Q^\delta})\arrow{dr}{\psi_\delta^{k-1}}\arrow{rr}{p_\delta^{k-1}} & &
      \hom_{k-1}(\D)\\
    %
    & \hom_{k-1}(\B)\arrow{ur}{i_*^{k-1}}
  \end{tikzcd}\end{equation}
  where $\psi_\delta^{k-1} : \hom_{k-1}(\hat{Q^\delta})\to \hom_{k-1}(\B)$ is induced by inclusion.

  Letting $\phi_0^{k-1} : \hom_{k-1}(B_0)\to\hom_{k-1}(\hat{Q^\delta})$ be the homomorphism induced by inclusion we have that $a^{k-1} = \psi_\delta^{k-1}\circ\phi_0^{k-1}$ so, because
  \[\eta_B^{k-1} = f^{k-1}\circ a^{k-1} = f^{k-1}\circ \psi_\delta^{k-1}\circ\phi_0^{k-1}\]
  and $\partial_1^k\circ\eta^k = \partial_0^k\circ \eta_B^{k-1}$ it follows that $\phi_0^{k-1}\circ\partial_0^k[y]$ is nonzero in $\hom_{k-1}(\hat{Q^\delta})$.
  Moreover, because $a^{k-1}\circ\partial_0^k[y]\in\im~\partial_*^k$ we have that $a^{k-1}\circ\partial_0^k[y]\in\ker~i_*^{k-1}$ by exactness, thus
  $\phi_0^{k-1}\circ\partial_0^k[y]\in \ker~p_\partial^{k-1}$ as $p_\delta^{k-1} = i_*^{k-1}\circ\psi_\delta^{k-1}$.
  That is, $\phi_0^{k-1}\circ\partial_0^k[y]\in \im~\partial_\delta^{k}$ by exactness.
  We can therefore construct a homomorphism $\mu^k : \hom_k(D_0, B_0) \to \hom_k(P^\delta, Q^\delta)$ for $[y]\in \hom_k(D_0, B_0)$ as the preimage of $\phi_0^{k-1}\partial_0^k[y]$ in $\hom_k(P^\delta, Q^\delta)$ for nonzero $[y''] = \eta^k[y]$, $0$ otherwise.


  Now, consider the long exact sequence of the pair $(\D, \hat{Q^\gamma})$
  \[\ldots\to\hom_k(\D, \hat{Q^\gamma})\xrightarrow{\partial^k_\gamma}
    \hom_{k-1}(\hat{Q^\gamma})\xrightarrow{p^{k-1}_\gamma}
    \hom_{k-1}(\D)\to\ldots.\]
  We have the following commutative diagrams

  \begin{small}\begin{subequations}\label{eq:main2}
  \begin{minipage}{0.5\textwidth}\begin{equation}\label{eq:main2a}\begin{tikzcd}[column sep=small]
      \hom_{k-1}(\B)\arrow{dr}{\psi_\gamma^{k-1}}\arrow{rr}{i_*^{k-1}} & &
      \hom_{k-1}(\D)\\
    & \hom_{k-1}(\hat{Q^\gamma})\arrow{ur}{p_\gamma^{k-1}}
  \end{tikzcd}\end{equation}\end{minipage}
  \begin{minipage}{0.43\textwidth}\begin{equation}\label{eq:main2b}\begin{tikzcd}
    \hom_{k}(\D, \hat{Q^\gamma})\arrow{r}{\partial_\gamma^k}\arrow{d}{\nu^k} &
    \hom_{k-1}(\hat{Q^\gamma})\arrow{d}{\phi_1^{k-1}}\\
    %
    \hom_{k}(D_1, B_1)\arrow{r}{\partial_1^k} &
    \hom_{k-1}(B_1)
  \end{tikzcd}\end{equation}\end{minipage}
  \end{subequations}\end{small}\vspace{2ex}

  \noindent where $\psi_\gamma^{k-1}, \sigma_\gamma^{k-1}, \phi_1^{k-1}$ and $\nu^k$ are induced by inclusion.

  Because $[z']\in\im~\partial_*^k$ we have $[z']\in\ker~i_*^{k-1}$ by exactness and, by commutativity of diagram~\ref{eq:main2a}, $[z']\in \ker~p_\gamma^{k-1}\circ\psi_\gamma^{k-1}$.
  Noting that $f^{k-1}$ factors through $\hom_{k-1}(\hat{Q^\gamma})$ as $f^{k-1} = \phi_1^{k-1}\circ\psi_\gamma^{k-1}$ we have that $\psi_\gamma^{k-1}[z']$ is nonzero in $\hom_{k-1}(Q^\gamma)$.
  So $\psi_\gamma^{k-1}[z']\in\ker~p_\gamma^{k-1}$ thus $\psi_\gamma^{k-1}[z'] \in\im~\hom_k(\D, \hat{Q^\gamma})$ by exactness.

  So we may conclude that $\eta^k$ factors through $\hat{\tau}^k : \hom_k(\D, \hat{Q^\delta})\to \hom_k(\D), \hat{Q^\gamma})$ with the maps $\mu^k = (\partial^k_\delta)^{-1}\circ \phi_0^{k-1}\circ\partial_0^k$ and $\nu^k : \hom_k(\D, \hat{Q^\gamma}) \to \hom_k(D_1, B_1)$ induced by inclusion.
  We therefore have the following sequence of homomorphisms
  \[ \hom_k(D_0, B_0)\xrightarrow{\mu^k} \hom_k(\D, \hat{Q^\delta})\to\hom_k(\D, \B)\to\hom_k(\D, \hat{Q^\gamma})\xrightarrow{\nu^k} \hom_k(D_1, B_1).\]
  So, by Lemma~\ref{lem:sandwich}, $\im~\eta^k\cong \hom_k(\D, \B)$ implies $\im~\hat{\tau}^k\cong \hom_k(\D, \B)$.
  The result follows from Lemma~\ref{lem:extension_iso} as
  \[ \im~\hom_k((P^\delta, Q^\delta)\hookrightarrow (P^\gamma, Q^\gamma))\cong\im~\hat{\tau}^k\cong \hom_k(\D, \B).\]
\end{proof}
