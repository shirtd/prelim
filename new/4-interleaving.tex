% !TeX root = ../new.tex



For two filtrations $\{F_\alpha\}_{\alpha\in\R}$ and $\{G_\alpha\}_{\alpha\in\R}$ we will write $F_\alpha\sim_\e G_\alpha$ to indicate that the persistence modules of the filtrations $\{F_\alpha\}$ and $\{G_\alpha\}$ are $\e$-interleaved.

\begin{definition}[Compatible Filtrations (Skraba~\cite{skraba14approximating})]
  Two filtrations $\{A_\alpha\}$ and $\{F_\alpha\}$ are \textbf{compatible} if the following diagram commutes for all $\alpha\leq\beta$
  \begin{equation}\begin{tikzcd}
    A_\alpha\arrow{r}\arrow{d} &
    F_\alpha\arrow{d} \\
    %
    A_\beta\arrow{r} &
    F_\beta
  \end{tikzcd}\end{equation}
\end{definition}

\begin{theorem}[Skraba~\cite{skraba14approximating}]
  Let $(\{F_\alpha\}, \{A_\alpha\})$ and $(\{G_\alpha\}, \{B_\alpha\})$ be pairs of compatible filtrations.
  If $F_\alpha\sim_{\e_1} G_\alpha$ and $A_\alpha\sim_{\e_2} B_\alpha$ then the relative modules $\{(F_\alpha, A_\alpha)\}$ and $\{(G_\alpha, B_\alpha)\}$ are $\max(\e_1, \e_2)$-interleaved.
\end{theorem}

Now, suppose $\{A_\alpha\}$, $\{B_\alpha\}$ are compatible with $\{F_\alpha\}$ and $\{C_\alpha\}$, $\{D_\alpha\}$ are compatible with $\{G_\alpha\}$.
If $A_\alpha\sim_{\e_1} C_\alpha$, $B_\alpha\sim_{\e_2} D_\alpha$, and $F_\alpha\sim_{\e_3} G_\alpha$ then
\[ (F_\alpha, A_\alpha)\sim_{\max(\e_1,\e_3)} (G_\alpha, C_\alpha)\]
and
\[ (F_\alpha, B_\alpha)\sim_{\max(\e_2,\e_3)} (G_\alpha, D_\alpha).\]
Let $\e = \max(\e_1, \e_2, \e_3)$ so both pairs of relative persistence modules are $\e$-interleaved.

% Consider the following commutative diagrams for $\alpha\leq\beta$


% \vspace{3ex}\begin{subequations}
% \begin{minipage}{0.5\textwidth}\begin{equation}\label{dgm:fab}\begin{tikzcd}
%   \hom_k(F_{\alpha-, A_\alpha)\arrow{r}{f_\alpha}\arrow{d}{a_\alpha^\beta} &
%   \hom_k(F_\alpha, B_\alpha)\arrow{d}{b_\alpha^\beta}\\
%   %
%   \hom_k(G_\beta, A_\beta)\arrow{r}{f_\beta} &
%   \hom_k(F_\beta, B_\beta)
% \end{tikzcd}\end{equation}\end{minipage}
% \begin{minipage}{0.5\textwidth}\begin{equation}\label{dgm:gcd}\begin{tikzcd}
%   \hom_k(G_\alpha, C_\alpha)\arrow{r}{g_\alpha}\arrow{d}{c_\alpha^\beta} &
%   \hom_k(G_\alpha, D_\alpha)\arrow{d}{d_\alpha^\beta}\\
%   %
%   \hom_k(G_\beta, C_\beta)\arrow{r}{g_\beta} &
%   \hom_k(G_\beta, D_\beta)
% \end{tikzcd}\end{equation}\end{minipage}
% \end{subequations}\vspace{3ex}

\begin{lemma}\label{lem:short_pair_inter}
  Suppose $(F_\alpha, A_\alpha)\sim_{\e} (G_\alpha, C_\alpha)$, $(F_\alpha, B_\alpha)\sim_\e (G_\alpha, D_\alpha)$, and the following diagrams commute for all $\beta\geq \alpha\in \Omega$.

  \vspace{3ex}\begin{subequations}
  \begin{minipage}{0.5\textwidth}\begin{equation}\label{dgm:fab}
  \begin{tikzcd}[column sep=scriptsize]
    \hom_k(F_\alpha, A_\alpha)\arrow{r}{f_\alpha}\arrow{d}{a_\alpha^\beta} &
    \hom_k(F_\alpha, B_\alpha)\arrow{d}{b_\alpha^\beta}\\
    %
    \hom_k(F_\beta, A_\beta)\arrow{r}{f_\beta} &
    \hom_k(F_\beta, B_\beta)
  \end{tikzcd}\end{equation}\end{minipage}
  \begin{minipage}{0.5\textwidth}\begin{equation}\label{dgm:gcd}
  \begin{tikzcd}[column sep=scriptsize]
    \hom_k(G_\alpha, C_\alpha)\arrow{r}{g_\alpha}\arrow{d}{c_\alpha^\beta} &
    \hom_k(G_\alpha, D_\alpha)\arrow{d}{d_\alpha^\beta}\\
    %
    \hom_k(G_\beta, C_\beta)\arrow{r}{g_\beta} &
    \hom_k(G_\beta, D_\beta)
  \end{tikzcd}\end{equation}\end{minipage}
  \end{subequations}\vspace{3ex}

  \vspace{3ex}\begin{subequations}
  \begin{minipage}{0.5\textwidth}\begin{equation}\label{dgm:fabgcd}
  \begin{tikzcd}[column sep=scriptsize]
    \hom_k(F_\alpha, A_\alpha)\arrow{r}{f_\alpha}\arrow{d}{m_{\alpha}} &
    \hom_k(F_\alpha, B_\alpha)\arrow{d}{n_\alpha}\\
    %
    \hom_k(G_{\alpha+\e}, C_{\alpha+\e})\arrow{r}{g_{\alpha+\e}} &
    \hom_k(G_{\alpha+\e}, D_{\alpha+\e})
  \end{tikzcd}\end{equation}\end{minipage}
  \begin{minipage}{0.5\textwidth}\begin{equation}\label{dgm:gcdfab}
  \begin{tikzcd}[column sep=scriptsize]
    \hom_k(G_\alpha, C_\alpha)\arrow{r}{g_\alpha}\arrow{d}{u_\alpha} &
    \hom_k(G_\alpha, D_\alpha)\arrow{d}{v_\alpha}\\
    %
    \hom_k(F_{\alpha+\e}, A_{\alpha+\e})\arrow{r}{f_{\alpha+\e}} &
    \hom_k(F_{\alpha+\e}, B_{\alpha+\e})
  \end{tikzcd}\end{equation}\end{minipage}
  \end{subequations}\vspace{3ex}

  \noindent Then
  \[ \{(F_\alpha, A_\alpha)\to (F_\alpha, B_\alpha)\}\]
  is $\e$-interleaved with
  \[\{(G_\alpha, C_\alpha)\to (G_\alpha, D_\alpha)\}.\]

\end{lemma}
\begin{proof}
%   \begin{tiny}
%   \vspace{3ex}\begin{subequations}
%   \begin{minipage}{0.5\textwidth}
%   \begin{equation}\label{dgm:fagc1}\begin{tikzcd}[column sep=tiny]
%     % Fa & & & Fb
%     \hom_k(F_{\alpha-\e}, A_{\alpha-\e})  \arrow[to=Fb, "a_{\alpha-\e}^{\beta+\e}"]
%                                           \arrow[to=Ga, "m_{\alpha-\e}"]
%     & & & |[alias=Fb]|
%       \hom_k(F_{\beta+e}, A_{\beta+\e}) \\
%     % & Ga & Gb &
%     & |[alias=Ga]|
%     \hom_k(G_\alpha, C_\alpha) \arrow[to=Gb, "c_\alpha^\beta"]
%     & |[alias=Gb]|
%       \hom_k(G_\beta, C_\beta) \arrow[to=Fb, "u_\beta"] &
%   \end{tikzcd}\end{equation}\end{minipage}
%   \begin{minipage}{0.5\textwidth}
%   \begin{equation}\label{dgm:fagc1}\begin{tikzcd}[column sep=tiny]
%     % & Fa & Fb &
%     & |[alias=Fa]|
%     \hom_k(F_\alpha, A_\alpha)  \arrow[to=Fb, "a_\alpha^\beta"]
%     & |[alias=Fb]|
%       \hom_k(F_\beta, A_\beta)  \arrow[to=Gb, "m_\beta"] & \\
%     % & Ga & Gb &
%     \hom_k(G_{\alpha-\e}, C_{\alpha-\e})  \arrow[to=Fa, "u_{\alpha-\e}"]
%                                           \arrow[to=Gb, "c_{\alpha-\e}^{\beta+\e}"]
%     & & & |[alias=Gb]|
%       \hom_k(G_{\beta+\e}, C_{\beta+\e})
%   \end{tikzcd}\end{equation}\end{minipage}
%   \end{subequations}\vspace{3ex}
% \end{tiny}

  % and $(F_\alpha, B_\alpha)\sim_\e (G_\alpha, D_\alpha)$ we know that $a_{\alpha-\e}

  Let $\Phi_\alpha = \im~f_\alpha$ and $\Psi_\alpha = \im~g_\alpha$ for all $\alpha\in\Omega$.
  We will show that the following four diagrams commute

  \begin{subequations}
  \begin{minipage}{0.45\textwidth}
  \begin{equation}\label{dgm:intr1}\begin{tikzcd}[column sep=scriptsize]
    % Fa & & & Fb
    \Phi_{\alpha-\e}  \arrow[to=Fb, "\phi_{\alpha-\e}^{\beta+\e}"]
                      \arrow[to=Ga, "\mu_{\alpha-\e}"]
    & & & |[alias=Fb]|
      \Phi_{\beta+\e} \\
    % & Ga & Gb &
    & |[alias=Ga]|
    \Psi_\alpha \arrow[to=Gb, "\psi_\alpha^\beta"]
    & |[alias=Gb]|
      \Psi_\beta \arrow[to=Fb, "\nu_\beta"] &
  \end{tikzcd}\end{equation}
  \begin{equation}\label{dgm:intr3}\begin{tikzcd}
    % Fa & Fb &
    \Phi_{\alpha-\e}  \arrow[to=Fb, "\phi_{\alpha-\e}^{\beta-\e}"]
                      \arrow[to=Ga, "\mu_{\alpha-\e}"]
    & |[alias=Fb]|
      \Phi_{\beta-\e} \arrow[to=Gb, "\mu_{\beta -\e}"] \\
    % & Ga & Gb
    & |[alias=Ga]|
    \Psi_\alpha \arrow[to=Gb, "\psi_\alpha^\beta"]
    & |[alias=Gb]|
      \Psi_\beta
  \end{tikzcd}\end{equation}
  \end{minipage} \begin{minipage}{0.45\textwidth}
  \begin{equation}\label{dgm:intr2}\begin{tikzcd}
    % Fa & & & Fb
    & |[alias=Fa]|
    \Phi_\alpha  \arrow[to=Fb, "\phi_\alpha^\beta"]
    & |[alias=Fb]|
      \Phi_\beta  \arrow[to=Gb, "\mu_\beta"] & \\
    % & Ga & Gb &
    \Psi_{\alpha-\e}  \arrow[to=Gb, "\psi_{\alpha-\e}^{\beta+\e}"]
                      \arrow[to=Fa, "\nu_{\alpha-\e}"]
    & & & |[alias=Gb]|
      \Psi_{\beta + \e}
  \end{tikzcd}\end{equation}
  \begin{equation}\label{dgm:intr4}\begin{tikzcd}
    % & Fa & Fb
    & |[alias=Fa]|
    \Phi_\alpha  \arrow[to=Fb, "\phi_\alpha^\beta"]
    & |[alias=Fb]|
      \Phi_\beta\\
    % Ga & Gb &
    \Psi_{\alpha-\e}  \arrow[to=Gb, "\psi_{\alpha-\e}^{\beta-\e}"]
                      \arrow[to=Fa, "\nu_{\alpha-\e}"]
    & |[alias=Gb]|
      \Psi_{\beta - \e} \arrow[to=Fb, "\nu_{\beta-\e}"]&
  \end{tikzcd}\end{equation}
  \end{minipage}
  \end{subequations}

  Where
  \[ \psi_\alpha^\beta = d_\alpha^\beta\rest_{\Psi_\alpha},\ \phi_\alpha^\beta = b_\alpha^\beta\rest_{\Phi_\alpha},\]
  \[ \mu_\alpha = n_\alpha\rest_{\Phi_\alpha},\text{ and } \nu_\alpha = v_\alpha\rest_{\Psi_\alpha}. \]

  We first make the following observations for any $\alpha\leq\beta$.
  \begin{itemize}
    \item Because Diagram~\ref{dgm:gcd} commutes $\im~\psi_\alpha^\beta = \im~d_\alpha^\beta\rest_{\im~g_\alpha}$ is a subspace of $\im~g_\beta = \Psi_\beta$, so
      \[ \nu_\beta\circ\psi_\alpha^\beta = v_\beta\rest_{\Psi_\beta}\circ d_\alpha^\beta\rest_{\Psi_\alpha} = v_\beta\circ d_\alpha^\beta\rest_{\Psi_\alpha}. \]
    \item Because Diagram~\ref{dgm:fabgcd} commutes $\im~\mu_{\alpha-\e} = \im~n_{\alpha-\e}\rest_{\Phi_{\alpha-\e}}$ is a subspace of $\im~g_\alpha = \Psi_\alpha$, so
      \[ \phi_\alpha^\beta\circ\mu_{\alpha-\e} = d_\alpha^\beta\rest_{\Psi_\alpha}\circ n_{\alpha-\e}\rest_{\Phi_{\alpha-\e}} = d_\alpha^\beta\circ n_{\alpha-\e}\rest_{\Phi_{\alpha-\e}}.\]
    \item Because Diagram~\ref{dgm:fab} commutes $\im~\phi_\alpha^\beta = \im~b_\alpha^\beta\rest_{\im~f_\alpha}$ is a subspace of $\im~f_\beta = \Phi_\beta$, so
      \[\phi_\alpha^\beta\circ \nu_{\alpha-\e} = b_\alpha^\beta\rest_{\Phi_\alpha}\circ v_{\alpha-\e}\rest_{\Psi_{\alpha-\e}} = b_\alpha^\beta\circ v_{\alpha-\e}\rest_{\Psi_{\alpha-\e}}.\]
    \item Because Diagram~\ref{dgm:gcdfab} commutes $\im~\nu_{\alpha-\e} = \im~v_{\alpha-\e}\rest_{\im~g_{\alpha-\e}}$ is a subspace of $\im~f_\alpha = \Phi_\alpha$, so
      \[ \mu_\beta\circ \phi_\alpha^\beta = n_\beta\rest_{\Phi_\beta}\circ b_\alpha^\beta\rest_{\Phi_\alpha} = n_\beta\circ b_\alpha^\beta\rest_{\Phi_\alpha}. \]
  \end{itemize}

  \begin{enumerate}[label=\Roman*.]
    \item $\im~\phi_\alpha^\beta\circ\mu_{\alpha-\e}$ is a subspace of $\im~g_\beta = \Psi_\beta$
      % $\im~\psi_\alpha^\beta = \im~d_\alpha^\beta\rest_{\im~g_\alpha}$ is a subspace of $\im~g_\beta = \Psi_\beta$ as Diagram~\ref{dgm:gcd} commutes for all $\beta\geq\alpha$, so
      % \[ \nu_\beta\circ\psi_\alpha^\beta = v_\beta\rest_{\Psi_\beta}\circ d_\alpha^\beta\rest_{\Psi_\alpha} = v_\beta\circ d_\alpha^\beta\rest_{\Psi_\alpha}. \]
      % Similarly, because Diagram~\ref{dgm:fabgcd} commutes $\im~\mu_{\alpha-\e} = \im~n_{\alpha-\e}\rest_{\Phi_{\alpha-\e}}$ is a subspace of $\im~g_\alpha = \Psi_\alpha$, therefore
      % \[ \phi_\alpha^\beta\circ\mu_{\alpha-\e} = d_\alpha^\beta\rest_{\Psi_\alpha}\circ n_{\alpha-\e}\rest_{\Phi_{\alpha-\e}} = d_\alpha^\beta\circ n_{\alpha-\e}\rest_{\Phi_{\alpha-\e}}.\]
      % So $\im~\phi_\alpha^\beta\circ\mu_{\alpha-\e}$ is a subspace of $\im~g_\beta = \Psi_\beta$ so
      \[ \nu_\beta\circ\psi_\alpha^\beta\circ\mu_{\alpha-\e} = v_\beta\circ d_\alpha^\beta\circ n_{\alpha-\e}\rest_{\Phi_{\alpha-\e}}.\]
      Because $(F_\alpha, B_\alpha)\sim_\e (G_\alpha, D_\alpha)$, $b_{\alpha-\e}^{\beta+\e} = v_\beta\circ d_\alpha^\beta\circ n_{\alpha-\e}$ for all $\beta\geq \alpha$.
      Therefore,
      \begin{align*}
        \phi_{\alpha-\e}^{\beta+\e} &= b_{\alpha-\e}^{\beta+\e}\rest_{\Phi_{\alpha-\e}}\\
          &= v_\beta\circ d_\alpha^\beta\circ n_{\alpha-\e}\rest_{\Phi_{\alpha-e}}\\
          &= \nu_\beta\circ\psi_\alpha^\beta\circ\mu_{\alpha-\e}
      \end{align*}
      so Diagram~\ref{dgm:intr1} commutes.

    \item $\phi_\alpha^\beta\circ \nu_{\alpha-\e}$ is a subspace of $\im~f_\beta = \Phi_\beta$ so
      % Because Diagrams~\ref{dgm:fab} and~\ref{dgm:gcdfab} commute for all $\alpha\leq\beta$ we have that $\im~\phi_\alpha^\beta = \im~b_\alpha^\beta\rest_{\im~f_\alpha}$ is a subspace of $\im~f_\beta = \Phi_\beta$ and $\im~\nu_{\alpha-\e} = \im~v_{\alpha-\e}\rest_{\im~g_{\alpha-\e}}$ is a subspace of $\im~f_\alpha = \Phi_\alpha$, respectively.
      % Therefore,
      \[ \mu_\beta\circ \phi_\alpha^\beta\circ \nu_{\alpha-\e} = n_\beta\circ b_\alpha^\beta\circ v_{\alpha-\e}\rest_{\Psi_{\alpha-\e}}. \]
      Because $(F_\alpha, B_\alpha)\sim_\e (G_\alpha, D_\alpha)$, $d_{\alpha-\e}^{\beta+\e} = n_\beta\circ b_\alpha^\beta\circ v_{\alpha-\e}$ so
      \begin{align*}
        \psi_{\alpha-\e}^{\alpha+\e} &= d_{\alpha-\e}^{\beta+\e}\rest_{g_{\alpha-\e}}\\
          &=n_\beta\circ b_\alpha^\beta\circ v_{\alpha-\e}\rest_{g_{\alpha-\e}}\\
          &= \mu_\beta\circ \phi_\alpha^\beta\circ \nu_{\alpha-\e}
      \end{align*}
      so Diagram~\ref{dgm:intr2} commutes.
    \item Because
      \[ \mu_{\beta - \e}\circ \phi_{\alpha-\e}^{\beta-\e} = n_{\beta-\e}\circ b_{\alpha-\e}^{\beta-\e}\rest_{\Phi_{\alpha-\e}}, \]
      \[ \psi_\alpha^\beta\circ\mu_{\alpha-\e} = d_\alpha^\beta\circ n_{\alpha-\e}\rest_{\Phi_{\alpha-\e}},\]
      and $(F_\alpha, B_\alpha)\sim_\e (G_\alpha, D_\alpha)$ imples $d_\alpha^\beta\circ n_{\alpha-\e} = n_{\beta-\e}\circ b_{\alpha-\e}$, we have
      \begin{align*}
        \mu_{\beta - \e}\circ \phi_{\alpha-\e}^{\beta-\e} &= n_{\beta-\e}\circ b_{\alpha-\e}^{\beta-\e}\rest_{\Phi_{\alpha-\e}}\\
          &= d_\alpha^\beta\circ n_{\alpha-\e}\rest_{\Phi_{\alpha-\e}}\\
          &= \psi_\alpha^\beta\circ\mu_{\alpha-\e}.
      \end{align*}
      So Diagram~\ref{dgm:intr3} commutes.
    \item Because
      \[\nu_{\beta-\e}\circ \psi_{\alpha-\e}^{\beta-\e} = v_{\beta-\e}\circ d_{\alpha-\e}^{\beta-\e}\rest_{\Psi_{\alpha-\e}},\]
      \[\phi_\alpha^\beta\circ \nu_{\alpha-\e} = b_\alpha^\beta\circ v_{\alpha-\e}\rest_{\Psi_{\alpha-\e}},\]
      and $(F_\alpha, B_\alpha)\sim_\e (G_\alpha, D_\alpha)$ implies $b_\alpha^\beta\circ v_{\alpha-\e} = v_{\beta-\e}\circ d_{\alpha-\e}^{\beta-\e}$ we have
      \begin{align*}
        \phi_\alpha^\beta\circ \nu_{\alpha-\e} &= b_\alpha^\beta\circ v_{\alpha-\e}\rest_{\Psi_{\alpha-\e}}\\
          &= v_{\beta-\e}\circ d_{\alpha-\e}^{\beta-\e}\rest_{\Psi_{\alpha-\e}}\\
          &= \nu_{\beta-\e}\circ \psi_{\alpha-\e}^{\beta-\e}.
      \end{align*}
      So Diagram~\ref{dgm:intr4} commutes.
    \end{enumerate}
\end{proof}

\begin{lemma}
  The $k$th persistent homology modules of
  \[ \{(\P)_\alpha, \Q^\delta)\to ((\P)_\alpha, \QQ^\delta)\}_{\alpha\geq\omega+2c\of} \]
  are $c\of$-interleaved with those of
  \[ \{(\P_\alpha, \Q^\delta)\to (\P_\alpha,\QQ^\delta)\}_{\alpha\geq \omega+2c\of} \]
  for all $k > 0$.
\end{lemma}
\begin{proof}
  By Lemma~\ref{lem:ps_inter} $(\P)_\alpha\sim_{c\of} \P_\alpha$ for all $\alpha\in\R$ and therefore
  \[ ((\P)_\alpha, \Q^\delta)\sim_{c\of} (\P_\alpha, \Q^\delta)\text{ for } \alpha \geq \omega - 2c\of\]
  and
  \[ ((\P)_\alpha, \QQ^\delta)\sim_{c\of} (\P_\alpha, \QQ^\delta)\text{ for }\alpha \geq \omega + 2c\delta.\]
  Because all maps are induced by inclusion the following diagrams commute for all $\beta\geq\alpha\geq\omega+2c\delta$.

  \begin{scriptsize}
  \vspace{3ex}\begin{subequations}
  \begin{minipage}{0.5\textwidth}\begin{equation}\label{dgm:fab}
  \begin{tikzcd}[column sep=scriptsize]
    \hom_k((\P)_\alpha, \Q^\delta)\arrow{r} \arrow{d} &
    \hom_k((\P)_\alpha, \QQ^\delta)\arrow{d} \\
    %
    \hom_k((\P)_\beta, \Q^\delta)\arrow{r} &
    \hom_k(\P)_\beta, \QQ^\delta)
  \end{tikzcd}\end{equation}\end{minipage}
  \begin{minipage}{0.5\textwidth}\begin{equation}\label{dgm:gcd}
  \begin{tikzcd}[column sep=scriptsize]
    \hom_k(\P_\alpha, \Q^\of)\arrow{r} \arrow{d} &
    \hom_k(\P_\alpha, \QQ^\of)\arrow{d} \\
    %
    \hom_k(\P_\beta, \Q^\of)\arrow{r} &
    \hom_k(\P_\beta, \QQ^\of)
  \end{tikzcd}\end{equation}\end{minipage}
  \end{subequations}\vspace{3ex}

  \vspace{3ex}\begin{subequations}
  \begin{minipage}{0.5\textwidth}\begin{equation}\label{dgm:fabgcd}
  \begin{tikzcd}[column sep=scriptsize]
    \hom_k((\P)_\alpha, \Q^\delta)\arrow{r}\arrow{d} &
    \hom_k((\P)_\alpha, \QQ^\delta)\arrow{d}\\
    %
    \hom_k(\P_{\alpha+c\delta}, \Q^\of)\arrow{r}&
    \hom_k(\P_{\alpha+c\delta}, \QQ^\of)
  \end{tikzcd}\end{equation}\end{minipage}
  \begin{minipage}{0.5\textwidth}\begin{equation}\label{dgm:gcdfab}
  \begin{tikzcd}[column sep=scriptsize]
    \hom_k(\P_\alpha, \Q^\of)\arrow{r}\arrow{d} &
    \hom_k(\P_\alpha, \Q^\of)\arrow{d}\\
    %
    \hom_k((\P)_{\alpha+\e}, \Q^\delta)\arrow{r} &
    \hom_k((\P)_{\alpha+\e}, \QQ^\delta)
  \end{tikzcd}\end{equation}\end{minipage}
  \end{subequations}\vspace{3ex}
  \end{scriptsize}

  The result therefore follows from Lemma~\ref{lem:short_pair_inter}.
\end{proof}

\begin{lemma}
  The $k$th persistent homology modules of $\{\hom_k(B_\alpha, \B)\}_{\alpha < 2c\of}$ and $\{(\P_\alpha, \Q^\delta)\to (\P_\alpha,\QQ^\delta)\}_{\alpha < 2c\of}$ are $c\of$-interleaved.
\end{lemma}
\begin{proof}
  Let $\Psi_\alpha := \hom_k(B_\alpha, \B)$ and $\Phi_\alpha := \im~\hom_k((\P_\alpha, \Q^\delta)\to (\P_\alpha,\QQ^\delta))$.
  Let $\psi_\alpha^\beta : \Psi_\alpha\to \Psi_\beta$ and $\phi_\alpha^\beta : \Phi_\alpha\to \Phi_\beta$.

  We have the folowing commutative diagrams induced by inclusion for all $\alpha\in\R$, where $\ext{\P_\alpha} := \P_\alpha\cup (D\setminus \P)$.

  \begin{scriptsize}
  \vspace{3ex}\begin{subequations}
  \begin{minipage}{0.5\textwidth}\begin{equation}\label{dgm:fab}
  \begin{tikzcd}[column sep=scriptsize]
    \hom_k(B_\alpha, \b)\arrow{r}{\rho_\alpha} \arrow{d}{f_\alpha^\beta} &
    \hom_k(B_\alpha, \B)\arrow{d}{g_\alpha^\beta} \\
    %
    \hom_k(B_\beta, \b)\arrow{r}{\rho_\beta} &
    \hom_k(B_\beta, \B)
  \end{tikzcd}\end{equation}
  % \end{minipage}
  % \begin{minipage}{0.5\textwidth}\begin{equation}\label{dgm:gcd}
  \begin{equation}
  \begin{tikzcd}[column sep=scriptsize]
    \hom_k(B_\alpha, \B)\arrow{r}{\sigma_\alpha} \arrow{d}{g_\alpha^\beta} &
    \hom_k(B_\alpha, \BB)\arrow{d}{h_\alpha^\beta} \\
    %
    \hom_k(B_\beta, \B)\arrow{r}{\sigma_\beta} &
    \hom_k(B_\beta, \BB)
  \end{tikzcd}\end{equation}%\end{minipage}
  \begin{equation}
  \begin{tikzcd}[column sep=scriptsize]
    \hom_k(B_{\alpha-c\of}, \b)\arrow{r}{\rho_{\alpha-c\of}} \arrow{d}{u_{\alpha-c\of}} &
    \hom_k(B_{\alpha-c\of}, \B)\arrow{d}{v_{\alpha-c\of}} \\
    %
    \hom_k(\ext{\P_\alpha}, \ext{\Q^\of})\arrow{r}{\ext{\tau_{\alpha}}} &
    \hom_k(\ext{\P_\alpha}, \ext{\QQ^\of})
  \end{tikzcd}\end{equation}\end{minipage}
  % \end{subequations}\vspace{3ex}
  % \vspace{3ex}\begin{subequations}
  \begin{minipage}{0.5\textwidth}\begin{equation}\label{dgm:fab}
  \begin{tikzcd}[column sep=scriptsize]
    \hom_k(\P_\alpha, \Q^\of)\arrow{r}{\tau_\alpha} \arrow{d}{a_\alpha^\beta} &
    \hom_k(\P_\alpha, \QQ^\of)\arrow{d}{b_\alpha^\beta} \\
    %
    \hom_k(\P_\beta, \Q^\of)\arrow{r}{\tau_\beta} &
    \hom_k(\P_\beta, \QQ^\of)
  \end{tikzcd}\end{equation}
  % \end{minipage}
  % \begin{minipage}{0.5\textwidth}\begin{equation}\label{dgm:fab}
  \begin{equation}
  \begin{tikzcd}[column sep=scriptsize]
    \hom_k(\ext{\P_\alpha}, \ext{\Q^\of})\arrow{r}{\ext{\tau_\alpha}} \arrow{d}{\ext{a_\alpha^\beta}} &
    \hom_k(\ext{\P_\alpha}, \ext{\QQ^\of})\arrow{d}{\ext{b_\alpha^\beta}} \\
    %
    \hom_k(\ext{\P_\beta}, \ext{\Q^\of})\arrow{r}{\ext{\tau_\beta}} &
    \hom_k(\ext{\P_\beta}, \ext{\QQ^\of})
  \end{tikzcd}\end{equation}
% \end{minipage}
  % \end{subequations}\vspace{3ex}
  % \vspace{3ex}\begin{subequations}
  % \begin{minipage}{0.5\textwidth}\begin{equation}\label{dgm:fab}
  \begin{equation}
  \begin{tikzcd}[column sep=scriptsize]
    \hom_k(\P_{\alpha-c\of}, \Q^\delta)\arrow{r}{\tau_{\alpha-c\of}} \arrow{d}{m_{\alpha-c\of}} &
    \hom_k(\P_{\alpha-c\of}, \QQ^\delta)\arrow{d}{n_{\alpha-c\of}} \\
    %
    \hom_k(B_\alpha, \B)\arrow{r}{\sigma_\alpha} &
    \hom_k(B_\alpha, \BB)
  \end{tikzcd}\end{equation}\end{minipage}
  % \begin{minipage}{0.5\textwidth}\begin{equation}\label{dgm:gcd}
  \end{subequations}\vspace{3ex}
  \end{scriptsize}

  Let
  \[ \mu_\alpha := n_\alpha\rest_{\im~\tau_\alpha},\ \nu_\alpha := v_\alpha\rest_{\im~\rho_\alpha}\]
  \[ t_\alpha^\beta := b_\alpha^\beta\rest_{\im~\tau_\alpha},\ \ext{t_\alpha^\beta} = \ext{b_\alpha^\beta}\rest_{\im~\ext{\tau_\alpha}}\]
  \[ p_\alpha^\beta := g_\alpha^\beta\rest_{\im~\rho_\alpha},\ s_\alpha^\beta := h_\alpha^\beta\rest_{\im~\sigma_\alpha}.\]
  % Noting that $\rho_\alpha$ is surjective for all $\alpha\in\R$ and $\sigma_\alpha$ is an isomorphism for all $\alpha\geq\omega+2c\of$ we also define
  \[q_\alpha^\beta := \sigma_\beta\circ g_\alpha^\beta\rest_{\im~\rho_\alpha}.\]%\ r_\alpha^\beta := \rho_\beta\circ h_\alpha^\beta\rest_{\im~\sigma_\alpha}.\]
  Noting that $\rho_\alpha$ is surjective for all $\alpha\in\R$ and $\sigma_\alpha$ is an isomorphism for all $\alpha\geq\omega+2c\of$ we observe that $g_\alpha^\beta$ is a map from $\hom_k(B_\alpha, \B)\cong \im\sigma_\alpha = \hom_k(B_\alpha, \BB)$ for $\alpha\geq\omega+2c\of$ to $\hom_k(B_\beta, \B)= \im~\rho_\beta$.
  We also define
  \[ \xi_\alpha : \hom_k(\ext{\P_\alpha}, \ext{\Q^\of})\to \hom_k(\P_\alpha, \Q^\of), \xi_\alpha' : \hom_k(\ext{\P_\alpha}, \ext{\QQ^\of})\to \hom_k(\P_\alpha, \QQ^\of)\]
  to be the isomorphisms give by excision, with inverses induced by inclusion.
  % \[ \zeta_\alpha : \hom_k(\P_\alpha, \Q^\of)\to \hom_k(\ext{\P_\alpha}, \ext{\Q^\of}),\  \zeta_\alpha' : \hom_k(\P_\alpha, \QQ^\of)\to \hom_k(\ext{\P_\alpha}, \ext{\QQ^\of})\]
  % induced by inclusion.

  We would like to show the following diagrams commute.

  % \vspace{3ex}
  % \begin{subequations}
  % \begin{minipage}{0.45\textwidth}
  \begin{equation}\label{dgm:intrr1}\begin{tikzcd}[column sep=scriptsize]
    % Fa & & & Fb
    \im~\tau_{\alpha-c\of}  \arrow[to=Fb, "t_{\alpha-c\of}^{\beta+c\of}"]
                      \arrow[to=Ga, "\mu_{\alpha-c\of}"]
    & & & |[alias=Fb]|
      \im~\tau_{\beta+c\of} \\
    % & Ga & Gb &
    & |[alias=Ga]|
    \im~\sigma_\alpha \arrow[to=Gb, "g_\alpha^\beta"]
    & |[alias=Gb]|
      \im~\rho_\beta \arrow[to=Fb, "\nu_\beta"] &
  \end{tikzcd}\end{equation}
  % \end{minipage} \begin{minipage}{0.45\textwidth}
  \begin{equation}\label{dgm:intrr3}\begin{tikzcd}
    % Fa & Fb &
    \im~\tau_{\alpha-c\of}  \arrow[to=Fb, "t_{\alpha-c\of}^{\beta-c\of}"]
                      \arrow[to=Ga, "\mu_{\alpha-c\of}"]
    & |[alias=Fb]|
      \im~\tau_{\beta-c\of} \arrow[to=Gb, "\mu_{\beta -c\of}"] \\
    % & Ga & Gb
    & |[alias=Ga]|
    \im~\sigma_\alpha \arrow[to=Gb, "s_\alpha^\beta"]
    & |[alias=Gb]|
      \im~\sigma_\beta
  \end{tikzcd}\end{equation}
  % \end{minipage}
  % \end{subequations}
  % \vspace{3ex}

  \begin{equation}\label{dgm:intrr2}\begin{tikzcd}
    % Fa & & & Fb
    & |[alias=Fa]|
    \im~\ext{\tau_\alpha}  \arrow[to=Fb, "\xi_\beta\circ\ext{t_\alpha^\beta}"]
    & |[alias=Fb]|
      \im~\tau_\beta  \arrow[to=Gb, "\mu_\beta"] & \\
    % & Ga & Gb &
    \im~\rho_{\alpha-c\of}  \arrow[to=Gb, "q_{\alpha-c\of}^{\beta+c\of}"]
                      \arrow[to=Fa, "\nu_{\alpha-c\of}"]
    & & & |[alias=Gb]|
      \im~\sigma_{\beta + c\of}
  \end{tikzcd}\end{equation}

  \begin{equation}\label{dgm:intr4}\begin{tikzcd}
    % & Fa & Fb
    & |[alias=Fa]|
    \im~\ext{\tau_\alpha}  \arrow[to=Fb, "\ext{t_\alpha^\beta}"]
    & |[alias=Fb]|
      \im~\ext{\tau_\beta}\\
    % Ga & Gb &
    \im~\rho_{\alpha-c\of}  \arrow[to=Gb, "p_{\alpha-c\of}^{\beta-c\of}"]
                      \arrow[to=Fa, "\nu_{\alpha-c\of}"]
    & |[alias=Gb]|
      \im~\rho_{\beta - c\of} \arrow[to=Fb, "\nu_{\beta-c\of}"]&
  \end{tikzcd}\end{equation}

  % First note that $\Phi_{\alpha-c\delta} = \im~\hom_k((\P_\alpha, \Q^\delta)\to (\P_\alpha,\QQ^\delta)) = 0$ for all $\alpha\leq \omega+2c\delta$ as
  % \[\hom_k(\P_{\alpha-c\delta},\QQ^\delta) = \hom_k(\P_{\omega + c\delta}, \QQ^\of) = 0.\]
  % So the following diagrams ``commute'' trivially.\textbf{TODO: need to define $\mu_\alpha, \nu_\alpha$}
  %
  % \vspace{3ex}
  % \begin{subequations}
  % \begin{minipage}{0.45\textwidth}
  % \begin{equation}\label{dgm:intrr1}\begin{tikzcd}[column sep=scriptsize]
  %   % Fa & & & Fb
  %   \Phi_{\alpha-c\of}  \arrow[to=Fb, "\phi_{\alpha-c\of}^{\beta+c\of}"]
  %                     \arrow[to=Ga, "\mu_{\alpha-c\of}"]
  %   & & & |[alias=Fb]|
  %     \Phi_{\beta+c\of} \\
  %   % & Ga & Gb &
  %   & |[alias=Ga]|
  %   \Psi_\alpha \arrow[to=Gb, "\psi_\alpha^\beta"]
  %   & |[alias=Gb]|
  %     \Psi_\beta \arrow[to=Fb, "\nu_\beta"] &
  % \end{tikzcd}\end{equation}
  % \end{minipage} \begin{minipage}{0.45\textwidth}
  % \begin{equation}\label{dgm:intrr3}\begin{tikzcd}
  %   % Fa & Fb &
  %   \Phi_{\alpha-c\of}  \arrow[to=Fb, "\phi_{\alpha-c\of}^{\beta-c\of}"]
  %                     \arrow[to=Ga, "\mu_{\alpha-c\of}"]
  %   & |[alias=Fb]|
  %     \Phi_{\beta-c\of} \arrow[to=Gb, "\mu_{\beta -c\of}"] \\
  %   % & Ga & Gb
  %   & |[alias=Ga]|
  %   \Psi_\alpha \arrow[to=Gb, "\psi_\alpha^\beta"]
  %   & |[alias=Gb]|
  %     \Psi_\beta
  % \end{tikzcd}\end{equation}
  % \end{minipage}
  % \end{subequations}
  % \vspace{3ex}

  % Now, we note that that $\Psi_{\alpha-c\delta} = \hom_k(B_{\alpha-c\delta}, \B) = 0$ for all $\alpha\leq \omega+c\delta$.
  % Suppose $\alpha\in (\omega+c\delta, \omega+2c\delta)$ and $[x]\in\hom_k(B_{\alpha-c\of}, \B)$.
  % So $\beta+c\of \geq \alpha+c\delta > \omega +2c\delta$ thus $\BB\subseteq B_{\beta+c\of}$.
  % As $\hom_k(A, \B)\cong \hom_k(A, \BB)$ for all $A$ containing $\BB$ we have $\hom_k(B_{\beta+c\of}, \B)\cong\hom_k(B_{\beta+c\of}, \BB)$.
  % Therefore, $[x]\in\hom_k(B_{\alpha-c\of}, \B)$ cannot be in $\hom_k(B_{\beta+c\of}, \B)$, so $[x]\in\ker~\psi_{\alpha-c\of}^{\beta+c\of}$ for all $\beta\geq\alpha$, $\alpha\leq 2c\delta$, and the following diagram ``commutes'' trivially.
  % \begin{equation}\label{dgm:intrr2}\begin{tikzcd}
  %   % Fa & & & Fb
  %   & |[alias=Fa]|
  %   \Phi_\alpha  \arrow[to=Fb, "\phi_\alpha^\beta"]
  %   & |[alias=Fb]|
  %     \Phi_\beta  \arrow[to=Gb, "\mu_\beta"] & \\
  %   % & Ga & Gb &
  %   \Psi_{\alpha-c\of}  \arrow[to=Gb, "\psi_{\alpha-c\of}^{\beta+c\of}"]
  %                     \arrow[to=Fa, "\nu_{\alpha-c\of}"]
  %   & & & |[alias=Gb]|
  %     \Psi_{\beta + c\of}
  % \end{tikzcd}\end{equation}
  %
  % \textbf{TODO: show the following diagram commutes for all $\alpha\leq\beta$, $\alpha\leq \omega + 2c\delta$.}
  % \begin{equation}\label{dgm:intr4}\begin{tikzcd}
  %   % & Fa & Fb
  %   & |[alias=Fa]|
  %   \Phi_\alpha  \arrow[to=Fb, "\phi_\alpha^\beta"]
  %   & |[alias=Fb]|
  %     \Phi_\beta\\
  %   % Ga & Gb &
  %   \Psi_{\alpha-c\of}  \arrow[to=Gb, "\psi_{\alpha-c\of}^{\beta-c\of}"]
  %                     \arrow[to=Fa, "\nu_{\alpha-c\of}"]
  %   & |[alias=Gb]|
  %     \Psi_{\beta - c\of} \arrow[to=Fb, "\nu_{\beta-c\of}"]&
  % \end{tikzcd}\end{equation}
\end{proof}

\begin{corollary}\label{cor:geo_inter}
  If $\eta^k : \hom_k(\b)\to \hom_k(\BB)$ is surjective and $\im~\eta^k\cong \hom_k(\bb)$ then the $k$th persistent homology modules of
  $\{(B_\alpha, \bb)\}_{\alpha\geq\oo}$ are $c\of$-interleaved with that of
  \[\{(P_\alpha^\of, \Q^\of)\to (P_\alpha^\of, \QQ^\of)\}_{\alpha\geq\oo}\]
  for $k > 0$.
\end{corollary}
