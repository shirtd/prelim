% !TeX root = ../main.tex

Let $\X$ denote an orientable $d$-manifold and $D\subset\X$ a compact subspace.
For a $c$-Lipschitz functon $f : D\to \R$ and $\alpha\in\R$ let $B_\alpha := f^{-1}((-\infty,\alpha])$ denote the $\alpha$-sublevel set of $f$.
Our sample will be denoted $P$, and the subset of points sampling $B_\alpha$ will be denoted $Q_\alpha := P\cap B_\alpha$.
For $\e > 0$ let $P^\e$ denote the union of open metric balls centered at points in $P$.
For ease of exposition let
\[ D\subi{z}{\alpha} := B_\alpha\cup B_z \]
denote the \emph{$z$-truncated} sublevel sets of $f$ and % of the restricted function $f\rest_{D\setminus B_w}$ for all $\alpha,w\in\R$.
\[ P\subi{z}{\alpha} := Q_\alpha\cup Q_z\]
for all $z,\alpha\in\R$.

We will select a sublevel set $B_\omega$ of $f$ that \emph{surrounds} $D$ to serve as our boundary.
Given a sample of $f$ at a finite number of points $P$ in $D$ we would like to confirm $P^\delta$ not only covers the interior $D\setminus B_\omega$, but also that $Q^\delta$ surrounds $P^\delta$ for some $Q\subset P$.
That is, we would like to verify that a pair $(P^\delta, Q^\delta)$ is representative of the pair $(D,B_\omega)$ in homology.
Our goal is to use this fact to approximate the persistence of $f$ relative to $B_\omega$.

Our approximation will be by a nested pair of (Vietoris-)Rips complexes, denoted $\rips^\e(P, Q) = (\rips^\e(P), \rips^\e(Q))$ for $\e > 0$.
Under mild regularity assumptions it can be shown that
\[ \rk~\hom_d(\rips^\delta(P, Q_{\omega - 2c\delta})\hookrightarrow \rips^{2\delta}(P, Q_{\omega+c\delta}))\geq \dim~\hom_0(\rips^\delta(P\setminus Q_{\omega-2c\delta}))\]
implies $D\setminus B_\omega\subseteq P^\delta$ and $Q_{\omega-2c\delta}^\delta$ surrounds $P^\delta$ in $D$.
Proof of this fact generalizes that of the TCC to boundaries defined in terms of a function $f$, eliminating unnatural assumptions made in previous work.
Not only are our subsamples $Q_{\omega-2c\delta}$ and $Q_{\omega+c\delta}$ defined by their function values, but our regularity assumptions can now be stated directly in terms of the persistent homology of $f$.

Given a sample $P$ that satisfies the TCC we can approximate the persistent homology of $f$ as follows.
The nested pair of Rips complexes used to confirm coverage can be extended to a filtration
\[ \{\rips^{2\delta}(P\subi{\omega-2c\delta}{\alpha}, Q_{\omega-2c\delta})\hookrightarrow \rips^{4\delta}(P\subi{\omega+c\delta}{\alpha}, Q_{\omega+c\delta})\}_{\alpha\in\R}\]
that can be used to approximate the persistent homology of $\{(D\subi{\omega}{\alpha}, B_\omega)\}_{\alpha\in\R}$.
The use of images of relative persistence modules is not only to eliminate noise at the boundary, but also to \emph{truncate} the persistence of $f$ in a way that isolates global structure.

\paragraph*{Outline}

We will begin with our statement of the TCC in Section~\ref{sec:tcc}.
A Part of the proof of the TCC will be generalized to properties of \emph{surrounding pairs}, simplifying our reformulation of the TCC in Theorem~\ref{thm:algo_tcc}.
Section~\ref{sec:middle} introduces extensions of surrounding pairs, as well as partial interleavings of image modules.
These are the main technical results used to show that a positive result from the TCC verifies that a surrounding pair of samples can be used to approximate the persistence of a function relative to a sublevel set in Theorem~\ref{thm:interleaving_main_2}.
In Section~\ref{sec:truncations} we provide an interpretation of this relative persistence as a truncation of the full diagram (i.e., the persistence of $f$ on all of $D$) that is motivated by examples from a proof-of-concept implementation in Section~\ref{sec:experiments}.
